# Предсказание температуры стали

### Задача
Чтобы оптимизировать производственные расходы, металлургический комбинат решил уменьшить потребление электроэнергии на этапе обработки стали. Нам нужно построить модель, которая предскажет последнюю температуру стали.
   
## Этапы исследования
**1. Исследовательский анализ данных.** Посмотреть на содержимое датасетов, выявить аномалии, пропуски, определить, какие правки потребуются.

**2. Предобработку данных.** Исправить названия столбцов, обработать пропуски, устранить аномалии. Определить признаки, которые влияют на последнюю температуру и подготовить общую таблицу со всеми необходимыми признаками для обучения модели.

**3. Построение модели.** Обучение разных моделей и оценка их качества, выбор лучшей модели.

**4. Тестирование модели.** Проверить качество лучшей модели на тестовой выборке.

**5. Подготовка отчета.** Описать проделанную работу и полученные результаты.

## Выводы
В ходе решения задачи была проделана следующая работа:

**1. Проведен исследовательский анализ данных:**
   - проведен обзор данных;
   - для каждого признака построена диаграмма размаха;
   - исследованы пропуски и аномалии;
   - определены необходимые для дальнейшей работы датафреймы.
   
   По итогу исследовательского анализа мы выяснили что требуется обработка пропусков, необходимо переименовать столбцы и требуется обработка аномалий.
   
**2. Проведена предобработка данных:**
   - устранены аномалии и пропуски;
   - сгенерированы новые признаки: полная мощность, средняя активная и реактивная мощность, общее время включения электродов, количество циклов, время плавки;
   - проведена агрегация внутри датафреймов по ключу;
   - все данные объеденены в один итоговый датафрейм по ключу;
   - данные исследованы на мультиколлинеарность;
   - проведен исследовательский анализ признаков итогового датафрейма.
   
   По итогу предобработки данных мы получили чистый датафрейм для построения модели. По матрице корреляций, изучена мультиколлинеарность признаков, отброшены незначимые признаки. Графический анализ распределения признаков показал, что признаки имеют преимущественно нормальное распределение, за исключением сыпучих и проволчных материалов.
   
**3. Построение модели:**
   - Константная модель, основанная на медианном значении температуры, показала MAE 7,63;
   - Линейная модель построена с помощью GridSearchCV с cv = 5, с параметрами fit_intercept = True, normalize = True показала MAE 6,02;
   - Модель градиентного бустинга CatBoost построена с помощью GridSearchCV с cv = 5, с параметрами iterations = 700, learning_rate = 0.03 показала MAE 5,93.
   
   CatBoost показала лучший результат, поэтому мы выбрали ее в качестве лучшей модели для тестирования.
   
**4. Тестирование модели:**
   - На тестовой выборке мы получили MAE равное 5,55.
   - Самыми важными признаками для модели оказались: общее время включения электродов, начальная температура и общее время плавки.
   
   Нам удалось достичь цель проекта: мы построили модель, предсказывающую последнюю температуру стали. Нам удалось достичь MAE < 6.8.
